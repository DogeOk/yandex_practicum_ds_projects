# Исследование технологического процесса очистки золота
## Цель проекта
Спрогнозировать концентрацию золота при проведении процесса очистки золота
## Описание данных
Данные находятся в трёх файлах:
+ [Обучающая выборка](https://code.s3.yandex.net/datasets/geo_data_0.csv);
+ [Тестовая выборка](https://code.s3.yandex.net/datasets/geo_data_1.csv);
+ [Исходные данные](https://code.s3.yandex.net/datasets/geo_data_2.csv).

Данные индексируются датой и временем получения информации (признак `date`). Соседние по времени параметры часто похожи.

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

**Технологический процесс**
+ Rougher feed — исходное сырье
+ Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
    + Xanthate — ксантогенат (промотер, или активатор флотации);
    + Sulphate — сульфат (на данном производстве сульфид натрия);
    + Depressant — депрессант (силикат натрия).
+ Rougher process (англ. «грубый процесс») — флотация
+ Rougher tails — отвальные хвосты
+ Float banks — флотационная установка
+ Cleaner process — очистка
+ Rougher Au — черновой концентрат золота
+ Final Au — финальный концентрат золота

**Параметры этапов**
+ air amount — объём воздуха
+ fluid levels — уровень жидкости
+ feed size — размер гранул сырья
+ feed rate — скорость подачи

## Наименование признаков
Наименование признаков строится следующим образом:

`[этап].[тип_параметра].[название_параметра]`

Возможные значения для блока `[этап]`:
+ rougher — флотация
+ primary_cleaner — первичная очистка
+ secondary_cleaner — вторичная очистка
+ final — финальные характеристики

Возможные значения для блока `[тип_параметра]`:
+ input — параметры сырья
+ output — параметры продукта
+ state — параметры, характеризующие текущее состояние этапа
+ calculation — расчётные характеристики

## Технологический процесс
Как золото получают из руды?

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

<img src="https://pictures.s3.yandex.net/resources/viruchka_1576238830.jpg">

Описание каждой стадии:

1. **Флотация**

Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.

На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

2. **Очистка**

Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

### Расчёт эффективности
Эффективность обогащения рассчитывается по формуле

<img src="https://pictures.s3.yandex.net/resources/Recovery_1576238822.jpg">

где:
+ C — доля золота в концентрате после флотации/очистки;
+ F — доля золота в сырье/концентрате до флотации/очистки;
+ T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества
Для решения задачи вводится метрика качества sMAPE.

<img src="https://pictures.s3.yandex.net/resources/smape_1576238825.jpg">

Нужно спрогнозировать сразу две величины:
+ эффективность обогащения чернового концентрата `rougher.output.recovery`;
+ эффективность обогащения финального концентрата `final.output.recovery`.

Итоговая метрика складывается из двух величин:

<img src="https://pictures.s3.yandex.net/resources/_smape_1576238814.jpg">

## Направление деятельности

<img src="https://img.shields.io/badge/%D0%9C%D0%B0%D1%88%D0%B8%D0%BD%D0%BD%D0%BE%D0%B5%20%D0%BE%D0%B1%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-rgb(110, 54, 48)?style=for-the-badge" alt="Машинное обучение" /> <img src="https://img.shields.io/badge/%D0%90%D0%BD%D0%B0%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0-rgb(40, 69, 108)?style=for-the-badge" alt="Аналитика" /> <img src="https://img.shields.io/badge/%D0%A0%D0%B5%D0%B3%D1%80%D0%B5%D1%81%D1%81%D0%B8%D1%8F-rgb(90, 90, 90)?style=for-the-badge" alt="Регрессия" />

## Навыки и инструменты

<img src="https://img.shields.io/badge/Python-rgb(96, 59, 44)?style=for-the-badge&logo=Python" alt="Python" /> <img src="https://img.shields.io/badge/Pandas-rgb(137, 99, 42)?style=for-the-badge&logo=Pandas" alt="Pandas" /> <img src="https://img.shields.io/badge/Matplotlib-rgb(105, 49, 76)?style=for-the-badge&logo=Matplotlib" alt="Matplotlib" /> <img src="https://img.shields.io/badge/NumPy-rgb(133, 76, 29)?style=for-the-badge&logo=NumPy" alt="NumPy" /> <img src="https://img.shields.io/badge/Scikit--learn-rgb(137, 99, 42)?style=for-the-badge&logo=Scikit-learn" alt="Scikit-learn" /> <img src="https://img.shields.io/badge/%D0%98%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B9%20%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-rgb(73, 47, 100)?style=for-the-badge" alt="Исследовательский анализ данных" />

## Вывод проекта

В данной работе были взяты данные из золотодобывающей отрасли. Целью было создать модель, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды. В ходе работы были выполнены следующие задачи:

+ изучены представленные данные;
+ проверены рассчёты эффективности обогащения;
+ проверена разница в признаках тренировачной и тестовой выборках;
+ предобработаны данные;
+ изучено изменение концентрации металлов на разных этапах очистки;
+ проведено сравнение распределения размеров сырья на разных этапах очистки;
+ исследована суммарная концентрация всех веществ на разных стадиях очистки;
+ написаны функции для вычисления sMAPE и итогового sMAPE;
+ выделены признаки и целевой признак;
+ найдены лучшие модели для целевых признаков;
+ лучшие модели обучены;
+ лучшие модели проверены итоговой метрикой на тестовой выборке.

Главная цель проекта была выполнена. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.